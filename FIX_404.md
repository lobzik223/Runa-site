# Исправление ошибки 404 на runafinance.online

## Проблема
Nginx возвращает 404 ошибку вместо проксирования запросов к Node.js серверу.

## Диагностика

### 1. Проверьте, запущен ли Node.js сервер на порту 3001:

```bash
# Проверка процесса
pm2 status

# Проверка порта
netstat -tulpn | grep 3001
# или
ss -tulpn | grep 3001

# Проверка локального доступа
curl http://localhost:3001
```

### 2. Проверьте логи PM2:

```bash
pm2 logs runa-site --lines 50
```

### 3. Проверьте логи Nginx:

```bash
# Логи ошибок
sudo tail -f /var/log/nginx/runa-site-error.log

# Логи доступа
sudo tail -f /var/log/nginx/runa-site-access.log
```

### 4. Проверьте конфигурацию Nginx:

```bash
# Проверка синтаксиса
sudo nginx -t

# Проверка активной конфигурации
sudo nginx -T | grep -A 20 "server_name runafinance.online"
```

## Решение

### Шаг 1: Убедитесь, что проект собран

```bash
cd /root/Runa-site  # или путь к вашему проекту
npm run build
```

Проверьте, что папка `dist` существует и содержит `index.html`:

```bash
ls -la dist/
cat dist/index.html | head -20
```

### Шаг 2: Запустите/перезапустите Node.js сервер

```bash
# Если используете PM2
pm2 restart runa-site

# Или запустите вручную для проверки
cd /root/Runa-site
node server.js
```

### Шаг 3: Обновите конфигурацию Nginx

```bash
# Скопируйте обновленную конфигурацию
sudo cp /root/Runa-site/nginx.conf /etc/nginx/sites-available/runafinance.online

# Создайте симлинк (если еще не создан)
sudo ln -sf /etc/nginx/sites-available/runafinance.online /etc/nginx/sites-enabled/

# Удалите дефолтную конфигурацию (если мешает)
sudo rm -f /etc/nginx/sites-enabled/default

# Проверьте конфигурацию
sudo nginx -t

# Перезагрузите Nginx
sudo systemctl reload nginx
```

### Шаг 4: Проверьте доступность

```bash
# С сервера
curl -I http://localhost:3001
curl -I http://runafinance.online

# Проверьте статус сервисов
systemctl status nginx
pm2 status
```

## Возможные причины 404

1. **Node.js сервер не запущен** - запустите через PM2 или вручную
2. **Папка dist не существует** - выполните `npm run build`
3. **Неправильная конфигурация Nginx** - обновите конфигурацию
4. **Конфликт с другой конфигурацией** - проверьте `/etc/nginx/sites-enabled/`
5. **Проблемы с правами доступа** - проверьте права на папку `dist`

## Быстрое исправление

```bash
# Полный цикл исправления
cd /root/Runa-site
npm run build
pm2 restart runa-site
sudo cp nginx.conf /etc/nginx/sites-available/runafinance.online
sudo nginx -t && sudo systemctl reload nginx
```

## Проверка после исправления

Откройте в браузере: `http://runafinance.online`

Должен загрузиться сайт, а не 404 ошибка.
